<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–£–ì–ò–ë–î–î ¬∑ –ï–¥–∏–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞</title>
    <link rel="stylesheet" href="css/styles.css">
</head>
<body>
    <div class="app" id="appRoot">
        <!-- –í–µ—Ä—Ö–Ω—è—è –ø–æ–ª–æ—Å–∞ (–±—É–¥–µ—Ç —Å–∫—Ä—ã—Ç–∞ –¥–æ –≤—Ö–æ–¥–∞) -->
        <div class="top-bar hidden" id="topBar">
            <div class="system-title">
                –£–ì–ò–ë–î–î ¬∑ <span>–ï–¥–∏–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞</span>
            </div>
            <div class="user-badge" id="userInfo"></div>
        </div>

        <!-- –ù–∞–≤–∏–≥–∞—Ü–∏—è (–±—É–¥–µ—Ç —Å–∫—Ä—ã—Ç–∞ –¥–æ –≤—Ö–æ–¥–∞) -->
        <div class="nav-bar hidden" id="navBar">
            <div class="nav-group">
                <button class="nav-btn" id="navHome">–ì–ª–∞–≤–Ω–∞—è</button>
                <button class="nav-btn" id="navProfile">–ü—Ä–æ—Ñ–∏–ª—å</button>
                <button class="nav-btn" id="navKusp">–ö–£–°–ü</button>
                <button class="nav-btn" id="navAdmin" hidden>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ</button>
            </div>
            <div class="nav-group">
                <button class="nav-btn logout" id="navLogout">–í—ã—Ö–æ–¥</button>
            </div>
        </div>

        <!-- –¶–µ–Ω—Ç—Ä–∞–ª—å–Ω–∞—è —á–∞—Å—Ç—å -->
        <div class="main-stage" id="centerStage">
            <div class="content-card" id="workPanel">
                <!-- –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è -->
                <div id="authSection">
                    <div class="auth-box">
                        <h2 style="border:none; text-align:center;">–í—Ö–æ–¥ –≤ —Å–∏—Å—Ç–µ–º—É</h2>
                        <input id="login" type="text" placeholder="–õ–æ–≥–∏–Ω">
                        <input id="password" type="password" placeholder="–ü–∞—Ä–æ–ª—å">
                        <button id="loginBtn" style="width:100%;">–í–æ–π—Ç–∏</button>
                    </div>
                </div>

                <!-- –û—Å–Ω–æ–≤–Ω–æ–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å (–ø–æ—Å–ª–µ –≤—Ö–æ–¥–∞) -->
                <div id="mainApp" class="hidden"></div>
            </div>
        </div>
    </div>

    <!-- –®–∞–±–ª–æ–Ω—ã -->
    <template id="homeTemplate">
        <div>
            <h2>–ì–ª–∞–≤–Ω—ã–π —ç–∫—Ä–∞–Ω</h2>
            <div id="greetingMessage" style="font-size:1.3rem; background:#f2f7ff; padding:16px 20px; border-radius:20px; margin-bottom:20px;"></div>
            <p style="color:#34597a;">–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ –µ–¥–∏–Ω—É—é —Å–∏—Å—Ç–µ–º—É —É—á—ë—Ç–∞ –ø—Ä–æ–∏—Å—à–µ—Å—Ç–≤–∏–π –∏ –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤ –ö–£–°–ü.</p>
            <p style="margin-top:16px;">–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –Ω–∞–≤–∏–≥–∞—Ü–∏—é –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å —É—á—ë—Ç–Ω—ã–º–∏ –∑–∞–ø–∏—Å—è–º–∏ –∏ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ —Å–æ–æ–±—â–µ–Ω–∏–π.</p>
        </div>
    </template>

    <template id="profileTemplate">
        <div>
            <h2>–ü—Ä–æ—Ñ–∏–ª—å —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞</h2>
            <div class="info-row"><span class="info-label">–õ–æ–≥–∏–Ω</span><span class="info-value" id="profileNickname"></span></div>
            <div class="info-row"><span class="info-label">–ó–≤–∞–Ω–∏–µ</span><span class="info-value" id="profileRank"></span></div>
            <div class="info-row"><span class="info-label">–û—Ç–¥–µ–ª</span><span class="info-value" id="profileDepartment"></span></div>
            <div class="info-row"><span class="info-label">–ö–∞—Ç–µ–≥–æ—Ä–∏—è</span><span class="info-value" id="profileCategory"></span></div>
        </div>
    </template>

    <template id="adminTemplate">
		<div style="height: 100%; display: flex; flex-direction: column;">
			<h2>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞–º–∏</h2>
			
			<!-- –í–∫–ª–∞–¥–∫–∏ -->
			<div style="display: flex; gap: 8px; margin-bottom: 24px; border-bottom: 2px solid #eaf0f8; padding-bottom: 8px;">
				<button id="manageTabBtn" class="nav-btn active" style="border-radius: 30px;">üë• –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∞–∫–∫–∞—É–Ω—Ç–∞–º–∏</button>
				<button id="createTabBtn" class="nav-btn" style="border-radius: 30px;">‚ûï –°–æ–∑–¥–∞–Ω–∏–µ –∞–∫–∫–∞—É–Ω—Ç–æ–≤</button>
			</div>

			<!-- –°–µ–∫—Ü–∏—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∞–∫–∫–∞—É–Ω—Ç–∞–º–∏ -->
			<div id="manageAccountsSection" style="flex: 1; display: flex; flex-direction: column;">
				<h3>–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ —É–¥–∞–ª–µ–Ω–∏–µ</h3>
				<div style="background: #f5f9ff; border-radius: 24px; padding: 16px; flex: 1; overflow-y: auto;">
					<div id="employeesManageList" style="list-style: none; padding: 0;"></div>
				</div>
			</div>

			<!-- –°–µ–∫—Ü–∏—è —Å–æ–∑–¥–∞–Ω–∏—è –∞–∫–∫–∞—É–Ω—Ç–æ–≤ (–∏–∑–Ω–∞—á–∞–ª—å–Ω–æ —Å–∫—Ä—ã—Ç–∞) -->
			<div id="createAccountSection" class="hidden" style="flex: 1; display: flex; flex-direction: column;">
				<h3>–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –Ω–æ–≤–æ–≥–æ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞</h3>
				<div style="background: #f5f9ff; border-radius: 24px; padding: 20px; margin-bottom: 20px;">
					<input id="nickname" placeholder="–õ–æ–≥–∏–Ω *">
					<input id="newPassword" type="password" placeholder="–ü–∞—Ä–æ–ª—å *">
					<input id="rank" placeholder="–ó–≤–∞–Ω–∏–µ *">
					<input id="department" placeholder="–ü–æ–¥—Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ *">
					<select id="category">
						<option value="–†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ">–†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ</option>
						<option value="–û–ø–µ—Ä–∞—Ç–∏–≤–Ω—ã–π">–û–ø–µ—Ä–∞—Ç–∏–≤–Ω—ã–π</option>
						<option value="–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä">–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä</option>
					</select>
					<button id="createUserBtn">‚ûï –°–æ–∑–¥–∞—Ç—å —É—á—ë—Ç–Ω—É—é –∑–∞–ø–∏—Å—å</button>
				</div>

				<h3>–°–ø–∏—Å–æ–∫ –ª–∏—á–Ω–æ–≥–æ —Å–æ—Å—Ç–∞–≤–∞</h3>
				<div style="background: #f5f9ff; border-radius: 24px; padding: 16px; flex: 1; overflow-y: auto;">
					<ul id="employeesList" style="list-style: none; padding: 0;"></ul>
				</div>
			</div>
		</div>
	</template>

    <template id="kuspListTemplate">
		<div style="height: 100%; display: flex; flex-direction: column;">
			<div style="display: flex; gap: 12px; align-items: center; margin-bottom: 20px; flex-shrink: 0;">
				<h2 style="margin:0; border:none;">–ö–£–°–ü</h2>
				<input type="text" id="kuspSearch" placeholder="–ü–æ–∏—Å–∫ –ø–æ –Ω–æ–º–µ—Ä—É –∏–ª–∏ –∑–∞—è–≤–∏—Ç–µ–ª—é..." style="flex:1;">
				<select id="kuspFilterStatus" style="width:150px;">
					<option value="">–í—Å–µ —Å—Ç–∞—Ç—É—Å—ã</option>
					<option value="new">–ù–æ–≤—ã–µ</option>
					<option value="in_progress">–í —Ä–∞–±–æ—Ç–µ</option>
					<option value="closed">–ó–∞–∫—Ä—ã—Ç—ã–µ</option>
				</select>
				<button id="kuspCreateOpen" class="secondary">+ –°–æ–∑–¥–∞—Ç—å</button>
			</div>
			<div class="list-panel" id="kuspList" style="flex:1;"></div>
		</div>
	</template>

    <template id="kuspCreateTemplate">
		<div>
			<input id="new_reporter" placeholder="–ó–∞—è–≤–∏—Ç–µ–ª—å *" required>
			<input id="new_contact" placeholder="–ö–æ–Ω—Ç–∞–∫—Ç">
			<select id="new_type">
				<option value="–∑–≤–æ–Ω–æ–∫">–ó–≤–æ–Ω–æ–∫</option>
				<option value="–∑–∞—è–≤–ª–µ–Ω–∏–µ">–ó–∞—è–≤–ª–µ–Ω–∏–µ</option>
				<option value="–æ—á–µ–≤–∏–¥–µ—Ü">–û—á–µ–≤–∏–¥–µ—Ü</option>
				<option value="–∏–Ω—Ü–∏–¥–µ–Ω—Ç">–ò–Ω—Ü–∏–¥–µ–Ω—Ç</option>
			</select>
			<input id="new_location" placeholder="–ú–µ—Å—Ç–æ">
			<select id="new_priority">
				<option value="low">–ù–∏–∑–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç</option>
				<option value="normal" selected>–°—Ä–µ–¥–Ω–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç</option>
				<option value="high">–í—ã—Å–æ–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç</option>
			</select>
			<textarea id="new_description" placeholder="–û–ø–∏—Å–∞–Ω–∏–µ *" rows="4" required></textarea>
			<div class="flex-row" style="justify-content: flex-end; margin-top: 16px;">
				<button id="cancelCreateBtn" class="secondary">–û—Ç–º–µ–Ω–∞</button>
				<button id="createKuspBtn">–°–æ–∑–¥–∞—Ç—å</button>
			</div>
		</div>
	</template>

    <!-- Supabase -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <!-- –ú–æ–¥—É–ª–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è -->
    <script src="js/config.js"></script>
    <script src="js/auth.js"></script>
    <script src="js/ui.js"></script>
    <script src="js/admin.js"></script>
    <script src="js/kusp.js"></script>
    <script src="js/app.js"></script>
</body>
</html>