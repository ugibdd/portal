<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–£–ì–ò–ë–î–î ¬∑ –ï–¥–∏–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞</title>
    
    <link rel="icon" type="image/x-icon" href="img/icon.ico">
    <link rel="shortcut icon" href="img/icon.ico">
    <link rel="apple-touch-icon" href="img/icon.png">
    
    <link rel="stylesheet" href="css/styles.css">
</head>
<body>
    <div class="app" id="appRoot">
        <!-- –í–µ—Ä—Ö–Ω—è—è –ø–æ–ª–æ—Å–∞ -->
        <div class="top-bar hidden" id="topBar">
            <div class="system-title">
                –£–ì–ò–ë–î–î ¬∑ <span id="systemTitleSpan">–ï–¥–∏–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞</span>
            </div>
            <div class="user-badge" id="userInfo"></div>
        </div>

        <!-- –ù–∞–≤–∏–≥–∞—Ü–∏—è –¥–ª—è —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ -->
        <div class="nav-bar hidden" id="navBar">
            <div class="nav-group">
                <button class="nav-btn" id="navHome">–ì–ª–∞–≤–Ω–∞—è</button>
                <button class="nav-btn" id="navProfile">–ü—Ä–æ—Ñ–∏–ª—å</button>
                <button class="nav-btn" id="navKusp">–ö–£–°–ü</button>
				<button class="nav-btn" id="navProtocols">–ü—Ä–æ—Ç–æ–∫–æ–ª—ã</button>
                <button class="nav-btn" id="navAdmin" hidden>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ</button>
            </div>
            <div class="nav-group">
                <button class="nav-btn logout" id="navLogout">–í—ã—Ö–æ–¥</button>
            </div>
        </div>

        <!-- –ù–∞–≤–∏–≥–∞—Ü–∏—è –¥–ª—è –≥–æ—Å—Ç–µ–π -->
        <div class="nav-bar hidden" id="guestNavBar">
            <div class="nav-group">
                <button class="nav-btn" id="guestNavHome">–ì–ª–∞–≤–Ω–∞—è</button>
                <button class="nav-btn" id="guestNavAppeals">–ú–æ–∏ –æ–±—Ä–∞—â–µ–Ω–∏—è</button>
                <button class="nav-btn" id="guestNavInfo">–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è</button>
            </div>
            <div class="nav-group">
                <button class="nav-btn" id="guestNavToEmployee">üëÆ‚Äç‚ôÇÔ∏è –í—Ö–æ–¥ –¥–ª—è —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤</button>
            </div>
        </div>

        <!-- –¶–µ–Ω—Ç—Ä–∞–ª—å–Ω–∞—è —á–∞—Å—Ç—å -->
        <div class="main-stage" id="centerStage">
            <div class="content-card" id="workPanel">
                <!-- –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è -->
                <div id="authSection">
                    <div class="system-badge">
                        <div style="text-align: center; margin-bottom: 20px;">
                            <img src="img/emblem.png" alt="–≠–º–±–ª–µ–º–∞" style="width: 300px; height: auto;">
                        </div>
                        <div class="system-title">–£–ì–ò–ë–î–î –ú–í–î –ø–æ –†–µ—Å–ø—É–±–ª–∏–∫–µ –ü—Ä–æ–≤–∏–Ω—Ü–∏—è</div>
                        <div class="system-subtitle">–ï–¥–∏–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞</div>
                    </div>
                    
                    <div class="auth-container">
                        <!-- –ö–∞—Ä—Ç–æ—á–∫–∞ –¥–ª—è –≥—Ä–∞–∂–¥–∞–Ω -->
                        <div class="auth-card">
                            <h2>–í—Ö–æ–¥ –¥–ª—è –≥—Ä–∞–∂–¥–∞–Ω</h2>
                            <button class="guest-button" id="guestAccessBtn">–ü–µ—Ä–µ–π—Ç–∏ –∫ –≥–æ—Å—Ç–µ–≤–æ–º—É –¥–æ—Å—Ç—É–ø—É</button>
                            <p>–ü—Ä–æ—Å–º–æ—Ç—Ä –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏, –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –æ–±—Ä–∞—â–µ–Ω–∏–π –±–µ–∑ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏.</p>
                            <div style="flex:1"></div>
                        </div>

                        <!-- –ö–∞—Ä—Ç–æ—á–∫–∞ –¥–ª—è —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ -->
                        <div class="auth-card">
                            <h2>–í—Ö–æ–¥ –¥–ª—è —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤</h2>
                            
                            <div class="form-group">
                                <label for="login">–õ–æ–≥–∏–Ω</label>
                                <input type="text" id="login" name="login" placeholder="–í–≤–µ–¥–∏—Ç–µ –ª–æ–≥–∏–Ω">
                            </div>
                            
                            <div class="form-group">
                                <label for="password">–ü–∞—Ä–æ–ª—å</label>
                                <input type="password" id="password" name="password" placeholder="–í–≤–µ–¥–∏—Ç–µ –ø–∞—Ä–æ–ª—å">
                            </div>
                            
                            <button class="login-btn" id="loginBtn">–í–æ–π—Ç–∏ –≤ —Å–∏—Å—Ç–µ–º—É</button>
                            
                            <div style="flex:1"></div>
                        </div>
                    </div>
                    
                    <div class="auth-footer">
                        ¬© –£–ì–ò–ë–î–î –ú–í–î –ø–æ –†–µ—Å–ø—É–±–ª–∏–∫–µ –ü—Ä–æ–≤–∏–Ω—Ü–∏—è, 2026. –í—Å–µ –ø—Ä–∞–≤–∞ –∑–∞—â–∏—â–µ–Ω—ã.
                    </div>
                </div>

                <!-- –û—Å–Ω–æ–≤–Ω–æ–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å (–ø–æ—Å–ª–µ –≤—Ö–æ–¥–∞) -->
                <div id="mainApp" class="hidden"></div>
            </div>
        </div>
    </div>

    <!-- –®–∞–±–ª–æ–Ω—ã –¥–ª—è —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ -->
    <template id="homeTemplate">
        <div>
            <h2>–ì–ª–∞–≤–Ω—ã–π —ç–∫—Ä–∞–Ω</h2>
            <div id="greetingMessage" style="font-size:1.3rem; background:#f2f7ff; padding:16px 20px; border-radius:20px; margin-bottom:20px;"></div>
            <p style="color:#34597a;">–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ –µ–¥–∏–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω—É—é —Å–∏—Å—Ç–µ–º—É –£–ì–ò–ë–î–î.</p>
            <p style="margin-top:16px;">–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –Ω–∞–≤–∏–≥–∞—Ü–∏—é –¥–ª—è —Ä–∞–±–æ—Ç—ã.</p>
        </div>
    </template>

    <template id="profileTemplate">
        <div>
            <h2>–ü—Ä–æ—Ñ–∏–ª—å —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞</h2>
            <div class="info-row"><span class="info-label">–õ–æ–≥–∏–Ω</span><span class="info-value" id="profileNickname"></span></div>
            <div class="info-row"><span class="info-label">–ó–≤–∞–Ω–∏–µ</span><span class="info-value" id="profileRank"></span></div>
            <div class="info-row"><span class="info-label">–û—Ç–¥–µ–ª</span><span class="info-value" id="profileDepartment"></span></div>
            <div class="info-row"><span class="info-label">–ö–∞—Ç–µ–≥–æ—Ä–∏—è</span><span class="info-value" id="profileCategory"></span></div>
        </div>
    </template>

    <template id="adminTemplate">
        <div style="height: 100%; display: flex; flex-direction: column;">
            <h2>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞–º–∏</h2>
            
            <!-- –í–∫–ª–∞–¥–∫–∏ -->
            <div style="display: flex; gap: 8px; margin-bottom: 24px; border-bottom: 2px solid #eaf0f8; padding-bottom: 8px; flex-wrap: wrap;">
				<button id="manageTabBtn" class="nav-btn active" style="border-radius: 30px;">üë• –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∞–∫–∫–∞—É–Ω—Ç–∞–º–∏</button>
				<button id="createTabBtn" class="nav-btn" style="border-radius: 30px;">‚ûï –°–æ–∑–¥–∞–Ω–∏–µ –∞–∫–∫–∞—É–Ω—Ç–æ–≤</button>
				<button id="logsTabBtn" class="nav-btn" style="border-radius: 30px;">üìã –ñ—É—Ä–Ω–∞–ª –¥–µ–π—Å—Ç–≤–∏–π</button>
			</div>

            <!-- –°–µ–∫—Ü–∏—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∞–∫–∫–∞—É–Ω—Ç–∞–º–∏ -->
            <div id="manageAccountsSection" style="flex: 1; display: flex; flex-direction: column;">
                <h3>–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ —É–¥–∞–ª–µ–Ω–∏–µ</h3>
                <div style="background: #f5f9ff; border-radius: 24px; padding: 16px; flex: 1; overflow-y: auto;">
                    <div id="employeesManageList" style="list-style: none; padding: 0;"></div>
                </div>
            </div>

            <!-- –°–µ–∫—Ü–∏—è —Å–æ–∑–¥–∞–Ω–∏—è –∞–∫–∫–∞—É–Ω—Ç–æ–≤ -->
            <div id="createAccountSection" class="hidden" style="flex: 1; display: flex; flex-direction: column;">
                <h3>–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –Ω–æ–≤–æ–≥–æ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞</h3>
                <div style="background: #f5f9ff; border-radius: 24px; padding: 24px; margin-bottom: 20px;">
                    <div class="form-group">
                        <label for="nickname">–õ–æ–≥–∏–Ω <span class="required">*</span></label>
                        <input id="nickname" type="text" placeholder="–í–≤–µ–¥–∏—Ç–µ –ª–æ–≥–∏–Ω –¥–ª—è –≤—Ö–æ–¥–∞">
                    </div>
                    
                    <div class="form-group">
                        <label for="newPassword">–ü–∞—Ä–æ–ª—å <span class="required">*</span></label>
                        <input id="newPassword" type="text" placeholder="–í–≤–µ–¥–∏—Ç–µ –ø–∞—Ä–æ–ª—å">
                        <small class="field-hint">–ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –¥–ª–∏–Ω–∞: 6 —Å–∏–º–≤–æ–ª–æ–≤</small>
                    </div>
                    
                    <div class="form-group">
                        <label for="rank">–ó–≤–∞–Ω–∏–µ <span class="required">*</span></label>
                        <input id="rank" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: —Å—Ç–∞—Ä—à–∏–π –ª–µ–π—Ç–µ–Ω–∞–Ω—Ç">
                    </div>
                    
                    <div class="form-group">
                        <label for="department">–û—Ç–¥–µ–ª <span class="required">*</span></label>
                        <input id="department" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –û–ë">
                    </div>
                    
                    <div class="form-group">
                        <label for="category">–ö–∞—Ç–µ–≥–æ—Ä–∏—è <span class="required">*</span></label>
                        <select id="category">
                            <option value="–ú–°">–ú–ª–∞–¥—à–∏–π —Å–æ—Å—Ç–∞–≤ (–ú–°)</option>
                            <option value="–†–°">–†—É–∫–æ–≤–æ–¥—è—â–∏–π —Å–æ—Å—Ç–∞–≤ (–†–°)</option>
                            <option value="–í–†–°">–í—ã—Å—à–∏–π —Ä—É–∫–æ–≤–æ–¥—è—â–∏–π —Å–æ—Å—Ç–∞–≤ (–í–†–°)</option>
                            <option value="–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä">–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ü–∏—è</option>
                        </select>
                    </div>
                    
                    <button id="createUserBtn" style="margin-top: 16px;">‚ûï –°–æ–∑–¥–∞—Ç—å —É—á—ë—Ç–Ω—É—é –∑–∞–ø–∏—Å—å</button>
                </div>
            </div>
			
			<!-- –°–µ–∫—Ü–∏—è –∂—É—Ä–Ω–∞–ª–∞ –¥–µ–π—Å—Ç–≤–∏–π -->
			<div id="logsSection" class="hidden" style="flex: 1; display: flex; flex-direction: column;">
				<div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 16px; flex-wrap: wrap; gap: 10px;">
					<h3 style="margin:0;">–ñ—É—Ä–Ω–∞–ª –¥–µ–π—Å—Ç–≤–∏–π (–ø–æ—Å–ª–µ–¥–Ω–∏–µ 100 –∑–∞–ø–∏—Å–µ–π)</h3>
					<div style="display: flex; gap: 8px; flex-wrap: wrap;">
						<select id="logFilterAction" style="width: 150px;">
							<option value="">–í—Å–µ –¥–µ–π—Å—Ç–≤–∏—è</option>
							<option value="employee_create">–°–æ–∑–¥–∞–Ω–∏–µ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤</option>
							<option value="employee_update">–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ</option>
							<option value="employee_delete">–£–¥–∞–ª–µ–Ω–∏–µ</option>
							<option value="kusp_create">–°–æ–∑–¥–∞–Ω–∏–µ –ö–£–°–ü</option>
							<option value="kusp_update">–ò–∑–º–µ–Ω–µ–Ω–∏–µ –ö–£–°–ü</option>
							<option value="kusp_delete">–£–¥–∞–ª–µ–Ω–∏–µ –ö–£–°–ü</option>
							<option value="user_login">–í—Ö–æ–¥—ã –≤ —Å–∏—Å—Ç–µ–º—É</option>
						</select>
						<input type="date" id="logFilterDate" style="width: 140px;">
						<button id="refreshLogsBtn" class="small secondary">üîÑ –û–±–Ω–æ–≤–∏—Ç—å</button>
						<button id="exportLogsBtn" class="small secondary">üì• –≠–∫—Å–ø–æ—Ä—Ç</button>
					</div>
				</div>
				<div style="background: #f5f9ff; border-radius: 24px; padding: 16px; flex: 1; overflow-y: auto;">
					<div id="logsList" style="display: flex; flex-direction: column; gap: 8px;"></div>
				</div>
			</div>
        </div>
    </template>

	

    <template id="kuspListTemplate">
        <div style="height: 100%; display: flex; flex-direction: column;">
            <div style="display: flex; gap: 12px; align-items: center; margin-bottom: 20px; flex-shrink: 0;">
                <h2 style="margin:0; border:none;">–ö–£–°–ü</h2>
                <input type="text" id="kuspSearch" placeholder="–ü–æ–∏—Å–∫ –ø–æ –Ω–æ–º–µ—Ä—É –∏–ª–∏ –∑–∞—è–≤–∏—Ç–µ–ª—é" style="flex:1;">
                <select id="kuspFilterStatus" style="width:150px;">
                    <option value="">–í—Å–µ —Å—Ç–∞—Ç—É—Å—ã</option>
                    <option value="new">–ù–æ–≤—ã–µ</option>
                    <option value="in_progress">–í —Ä–∞–±–æ—Ç–µ</option>
                    <option value="closed">–ó–∞–∫—Ä—ã—Ç—ã–µ</option>
                </select>
                <button id="kuspCreateOpen" class="secondary">+ –°–æ–∑–¥–∞—Ç—å</button>
            </div>
            <div class="list-panel" id="kuspList" style="flex:1;"></div>
        </div>
    </template>

    <!-- –®–∞–±–ª–æ–Ω—ã –¥–ª—è –≥–æ—Å—Ç–µ–π -->
    <template id="guestHomeTemplate">
        <div>
            <h2>–ü–æ—Ä—Ç–∞–ª –≥—Ä–∞–∂–¥–∞–Ω–∏–Ω–∞</h2>
            <div style="background:#f2f7ff; padding:20px; border-radius:20px; margin-bottom:20px;">
                <p>–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –Ω–∞ –ø–æ—Ä—Ç–∞–ª –≥—Ä–∞–∂–¥–∞–Ω–∏–Ω–∞ –£–ì–ò–ë–î–î.</p>
                <p>–ó–¥–µ—Å—å –≤—ã –º–æ–∂–µ—Ç–µ:</p>
                <ul style="margin-top:10px; list-style:disc; padding-left:20px;">
                    <li>–û—Ç—Å–ª–µ–¥–∏—Ç—å —Å—Ç–∞—Ç—É—Å –æ–±—Ä–∞—â–µ–Ω–∏—è –ø–æ –Ω–æ–º–µ—Ä—É —Ç–∞–ª–æ–Ω–∞-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è</li>
                    <li>–ü–æ–ª—É—á–∏—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Ä–∞–±–æ—Ç–µ –ì–ò–ë–î–î</li>
                </ul>
            </div>
        </div>
    </template>

	<template id="protocolListTemplate">
        <div style="height: 100%; display: flex; flex-direction: column;">
            <div style="display: flex; gap: 12px; align-items: center; margin-bottom: 20px; flex-shrink: 0;">
                <h2 style="margin:0; border:none;">–ü—Ä–æ—Ç–æ–∫–æ–ª—ã –æ–± –ê–ü</h2>
                <input type="text" id="protocolSearch" placeholder="–ü–æ–∏—Å–∫" style="flex:1;">
                <select id="protocolFilterStatus" style="width:150px;">
                    <option value="">–í—Å–µ —Å—Ç–∞—Ç—É—Å—ã</option>
                    <option value="active">–î–µ–π—Å—Ç–≤—É—é—â–∏–µ</option>
                    <option value="archived">–ê—Ä—Ö–∏–≤–Ω—ã–µ</option>
                </select>
                <button id="protocolCreateOpen" class="secondary">+ –ù–æ–≤—ã–π –ø—Ä–æ—Ç–æ–∫–æ–ª</button>
            </div>
            <div class="list-panel" id="protocolList" style="flex:1;"></div>
        </div>
    </template>

    <template id="guestAppealsTemplate">
        <div>
            <h2>–ú–æ–∏ –æ–±—Ä–∞—â–µ–Ω–∏—è</h2>
            <div style="background:#f5f9ff; padding:20px; border-radius:20px;">
                <p>–î–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –æ–±—Ä–∞—â–µ–Ω–∏–π –≤–≤–µ–¥–∏—Ç–µ –Ω–æ–º–µ—Ä —Ç–∞–ª–æ–Ω–∞-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è:</p>
                <div class="form-group">
                    <input type="text" id="appealNumber" placeholder="–ù–æ–º–µ—Ä —Ç–∞–ª–æ–Ω–∞-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è">
                </div>
                <button id="findAppealBtn" class="secondary">–ù–∞–π—Ç–∏</button>
                <div id="appealResult" style="margin-top:20px;"></div>
            </div>
        </div>
    </template>

    <template id="guestInfoTemplate">
        <div>
            <h2>–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è</h2>
            <div style="background:#f5f9ff; padding:20px; border-radius:20px;">
                <h3>–ö–æ–Ω—Ç–∞–∫—Ç—ã</h3>
                <p>üìû –î–µ–∂—É—Ä–Ω–∞—è —á–∞—Å—Ç—å: 8 (222) 555-58-48</p>
				<p>üìç –ê–¥—Ä–µ—Å: –≥. –ú–∏—Ä–Ω—ã–π, –ö—É—Ç—É–∑–æ–≤—Å–∫–∞—è –Ω–∞–±–µ—Ä–µ–∂–Ω–∞—è, –¥. 2</p>
                <p>üìß Forum: <a href="https://forum.gtaprovince.ru/forum/1182-ugibdd/" target="_blank" rel="noopener noreferrer">https://forum.gtaprovince.ru/forum/1182-ugibdd/</a></p>
				<p>üì∞ –ù–æ–≤–æ—Å—Ç–∏ –í–ö: <a href="https://vk.com/ugibddm.province_one" target="_blank" rel="noopener noreferrer">https://vk.com/ugibddm.province_one</a></p>   
                
                <h3 style="margin-top:20px;">–ß–∞—Å—ã —Ä–∞–±–æ—Ç—ã</h3>
                <p>–ü–Ω-–ü—Ç: 09:00 - 18:00</p>
				<p>–°–±: 10:00 - 17:00</p>
                <p>–í—Å: –í—ã—Ö–æ–¥–Ω–æ–π</p>
            </div>
        </div>
    </template>

    <!-- Supabase -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <!-- html2canvas –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è —Ç–∞–ª–æ–Ω–æ–≤ –≤ PNG -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <!-- –ú–æ–¥—É–ª–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è -->
    <script src="js/config.js"></script>
    <script src="js/error-handler.js"></script> 
	<script src="js/logger.js"></script>
    <script src="js/permissions.js"></script>
    <script src="js/auth.js"></script>
    <script src="js/supabase-admin-client.js"></script>
    <script src="js/ui.js"></script>
    <script src="js/admin.js"></script>
    <script src="js/kusp.js"></script>
	<script src="js/protocol.js"></script> 
    <script src="js/app.js"></script>
</body>
</html>